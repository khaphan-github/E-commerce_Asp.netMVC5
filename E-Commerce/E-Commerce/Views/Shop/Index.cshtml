@using E_Commerce_Business_Logic.HomepageItems;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/ECOMMERCE/_LayoutPage1.cshtml";
}
@using E_Commerce_Repository.Models;
@{ 
    HomepageItemsView LayoutView = new HomepageItemsView();
    var category = LayoutView.CategoryView();

    var productList = ViewData["ShopProduct"] as List<Product>;
    
}
<main class="main">
        	
            <nav aria-label="breadcrumb" class="breadcrumb-nav mb-2">
                <div class="container">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item"><a href="#">Shop</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Grid 4 Columns</li>
                    </ol>
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->

            <div class="page-content">
                <div class="container">
                	<div class="row">
                		<div class="col-lg-9">
                            <div class="products mb-3", id="products">
                                <div class="row justify-content-center">
                                    @foreach (var product in productList) {
                                        <!-- BEGIN PRODUCT -->
                                        <div class="col-9 col-md-2 col-lg-4 col-xl-3">
                                            <div class="product product-7 text-center">
                                                <figure class="product-media">
                                                    <a href="@Url.Action("Index", "Product", new { id = product.Id.ToString() })">
                                                        <img src="@product.ProductImages.First().URL" alt="Product image" class="product-image">
                                                    </a>

                                                    <div class="product-action-vertical">
                                                        <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>Xem</span></a>
                                                    </div><!-- End .product-action-vertical -->

                                                    <div class="product-action">
                                                        <a href="#" class="btn-product btn-cart"><span>Thêm giỏ hàng</span></a>
                                                    </div><!-- End .product-action -->
                                                </figure><!-- End .product-media -->

                                                <div class="product-body">
                                                    <div class="product-cat">
                                                        <!--product.TypeProduct.Name-->
                                                        <a href="#"></a>
                                                    </div><!-- End .product-cat -->
                                                    <h3 class="product-title"><a href="product.html">@product.Name</a></h3><!-- End .product-title -->
                                                    <div class="product-price">
                                                        @String.Format("{0:n0}", @product.Price) đ
                                                    </div><!-- End .product-price -->
                                                    <div class="ratings-container">
                                                        <div class="ratings">
                                                            <div class="ratings-val" style="width: 80%;"></div><!-- End .ratings-val -->
                                                        </div><!-- End .ratings -->
                                                        <span class="ratings-text">( 0 Reviews )</span>
                                                    </div><!-- End .rating-container -->

                                                    <div class="product-nav product-nav-thumbs">
                                                        @foreach (var image in product.ProductImages) {
                                                            <a href="#" class="active">
                                                                <img src="@image.URL" alt="product desc">
                                                            </a>
                                                        }


                                                    </div><!-- End .product-nav -->
                                                </div><!-- End .product-body -->
                                            </div><!-- End .product -->
                                        </div><!-- End .col-sm-6 col-lg-4 col-xl-3 -->
                                        <!-- END PRODUCT -->
                                    }
                                </div><!-- End .row -->
                            </div><!-- End .products -->


                		 <!--	<nav aria-label="Page navigation">
							    <ul class="pagination justify-content-center">
							        <li class="page-item disabled">
							            <a class="page-link page-link-prev" href="#" aria-label="Previous" tabindex="-1" aria-disabled="true">
							                <span aria-hidden="true"><i class="icon-long-arrow-left"></i></span>Prev
							            </a>
							        </li>
							        <li class="page-item active" aria-current="page"><a class="page-link" href="#">1</a></li>
							        <li class="page-item"><a class="page-link" href="#">2</a></li>
							        <li class="page-item"><a class="page-link" href="#">3</a></li>
							        <li class="page-item-total">of 6</li>
							        <li class="page-item">
							            <a class="page-link page-link-next" href="#" aria-label="Next">
							                Next <span aria-hidden="true"><i class="icon-long-arrow-right"></i></span>
							            </a>
							        </li>
							    </ul>
							</nav>
                             -->
                		</div><!-- End .col-lg-9 -->
                		<aside class="col-lg-3 order-lg-first">
                			<div class="sidebar sidebar-shop">
                				<div class="widget widget-clean">
                					<label>Filters:</label>
                					<a href="#" class="sidebar-filter-clear">Clean All</a>
                				</div><!-- End .widget widget-clean -->

                				<div class="widget widget-collapsible">
    								<h3 class="widget-title">
                                       
									    <a data-toggle="collapse" href="#widget-1" role="button" aria-expanded="true" style="font-family:Tahoma" aria-controls="widget-1">
                                            Danh mục sản phẩm
									    </a>
									</h3><!-- End .widget-title -->
                                <!--Category-->
									<div class="collapse show" id="widget-1">
                                        <div class="widget-body">
                                            @foreach (var ca in category) {
                                                <div class="filter-items filter-items-count">
                                            <!-- Action to category-->
                                                  <a href="">@ca.Name</a>
                                                </div><!-- End .filter-items -->
                                            }

                                        </div><!-- End .widget-body -->
									</div><!-- End .collapse -->
        						</div><!-- End .widget -->

        						<div class="widget widget-collapsible">
    								<h3 class="widget-title">
									    <a data-toggle="collapse" href="#widget-2" role="button" aria-expanded="true" style="font-family:Tahoma" aria-controls="widget-2">
									        Hãng sản suất
									    </a>
									</h3><!-- End .widget-title -->

									<div class="collapse show" id="widget-2">
										<div class="widget-body">
											<div class="filter-items">

												<div class="filter-item">
													<div class="custom-control custom-checkbox">
														<input type="checkbox" class="custom-control-input" id="size-1">
														<label class="custom-control-label" for="size-1">XS</label>
													</div><!-- End .custom-checkbox -->
												</div><!-- End .filter-item -->

											</div><!-- End .filter-items -->
										</div><!-- End .widget-body -->
									</div><!-- End .collapse -->
        						</div><!-- End .widget -->

        						<div class="widget widget-collapsible">
    								<h3 class="widget-title">
									    <a data-toggle="collapse" href="#widget-5" role="button" aria-expanded="true" aria-controls="widget-5">
									        Price
									    </a>
									</h3><!-- End .widget-title -->

									<div class="collapse show" id="widget-5">
										<div class="widget-body">
                                            <div class="filter-price">
                                                <div class="filter-price-text">
                                                    Price Range:
                                                    <span id="filter-price-range"></span>
                                                </div><!-- End .filter-price-text -->

                                                <div id="price-slider"></div><!-- End #price-slider -->
                                            </div><!-- End .filter-price -->
										</div><!-- End .widget-body -->
									</div><!-- End .collapse -->
        						</div><!-- End .widget -->
                			</div><!-- End .sidebar sidebar-shop -->
                		</aside><!-- End .col-lg-3 -->
                	</div><!-- End .row -->
                </div><!-- End .container -->
            </div><!-- End .page-content -->
        </main><!-- End .main -->
        @section Css{
              <link rel="stylesheet" href="/assets/css/plugins/nouislider/nouislider.css">
            }
        @section Js{
            <script src="assets/js/wNumb.js"></script>
            <script src="/assets/js/nouislider.min.js"></script>
            <script src="/assets/js/bootstrap-input-spinner.js"></script>
            <script>
                $(function () {
                    LoadProducts();
                    function LoadProducts() {
                        $.get("/Shop/Products",
                            {
                                Categories: [],
                                Sizes: [],
                                Color: [],
                                Brand: [],
                                PriceFrom: 0,
                                PriceTo: 10,
                                OrderBy: "Date",
                                Page: 1
                            },
                            function (items) {
                                console.log(items);
                                $("#products").html("");
                                items.forEach(function (element) 
                                {

                                    var picture = "";
                                    var pic = element[5].split(',');
                                    for (let i = 0; i < pic.length; i++) {
                                        picture += '<a href="#" class="active">' +
                                            '<img src="/assets/images/products/'+pic[i]+'" alt="product desc">' +
                                            '</a>'
                                    }
                                    
                                    var product = '<div class="col-6 col-md-4 col-lg-4 col-xl-3">' +
                                        '<div class="product product-7 text-center" >'+
                                        '<figure class="product-media">' +
                                        '<span class="product-label label-new">New</span>' +
                                        '<a href="/Shop/Details/'+element[0]+'">' +
                                        '<img src="/assets/images/products/' + element[1] + '" alt="Product image" class="product-image">' +
                                        '</a>' +

                                        '<div class="product-action-vertical">' +
                                        '<a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>add to wishlist</span></a>' +
                                        '<a href="popup/quickView.html" class="btn-product-icon btn-quickview" title="Quick view"><span>Quick view</span></a>' +
                                        '<a href="#" class="btn-product-icon btn-compare" title="Compare"><span>Compare</span></a>' +
                                        '</div><!-- End .product-action-vertical -->' +

                                        '<div class="product-action">' +
                                        '<a href="#" class="btn-product btn-cart"><span>add to cart</span></a>' +
                                        '</div><!-- End .product-action -->' +
                                        '</figure><!--End.product - media-- >' +

                                        '<div class="product-body">' +
                                        '<div class="product-cat">' +
                                        '<a href="#">' + element[2] + '</a>' +'</div><!-- End .product-cat -->' +
                                        '<h3 class="product-title"><a href="/Shop/Details/' + element[0] +'">' + element[3] + '</a></h3><!-- End .product-title -->' +
                                        '<div class="product-price">' + element[6] + 'đ</div><!-- End .product-price -->' +
                                        '<div class="ratings-container">' +
                                        '<div class="ratings">' +
                                        '<div class="ratings-val" style="width: ' + Math.floor(element[8]*20) + '%;"></div><!-- End .ratings-val -->' +
                                        '</div><!-- End .ratings -->' +
                                        '<span class="ratings-text">( ' + element[7] + ' Reviews )</span>' +
                                        '</div><!-- End .rating-container -->' +

                                        '<div class="product-nav product-nav-thumbs">' +
                                        picture+
                                        '</div><!-- End .product-nav -->' +
                                        '</div><!--End.product - body-- >' +
                                        '</div >< !--End.product -->' +
                                        '</div > ';
                                    $("#products").append(product)
                                        
                                });
                                
                            });
                    }
                });
            </script>
           }